<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-types/type-guards">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Type Guards | Flow</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://flow.org/en/docs/types/type-guards/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Type Guards | Flow"><meta data-rh="true" name="description" content="Flow lets you define functions whose return expression encodes some type predicate over a parameter param. This predicate is annotated in place of a return type annotation as param is PredicateType. It declares that if the function returns true then param is of type PredicateType."><meta data-rh="true" property="og:description" content="Flow lets you define functions whose return expression encodes some type predicate over a parameter param. This predicate is annotated in place of a return type annotation as param is PredicateType. It declares that if the function returns true then param is of type PredicateType."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://flow.org/en/docs/types/type-guards/"><link data-rh="true" rel="alternate" href="https://flow.org/en/docs/types/type-guards/" hreflang="en"><link data-rh="true" rel="alternate" href="https://flow.org/en/docs/types/type-guards/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://P6T3E8XPGT-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Flow RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Flow Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-49208336-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


<link rel="search" type="application/opensearchdescription+xml" title="Flow" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.aa18815f.css">
<link rel="preload" href="/assets/js/runtime~main.2e347048.js" as="script">
<link rel="preload" href="/assets/js/main.28c37e05.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>

<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Facebook Project Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Facebook Project Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a class="navbar__item navbar__link" href="/en/docs/getting-started/">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/">Docs</a><a class="navbar__item navbar__link" href="/try/">Try</a><a class="navbar__item navbar__link" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://twitter.com/flowtype" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__icon twitter__link" aria-label="Twitter"></a><a href="http://stackoverflow.com/questions/tagged/flowtype" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__icon stackoverflow__link" aria-label="Stack Overflow"></a><a href="https://github.com/facebook/flow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__icon github__link" aria-label="GitHub"></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/getting-started/">Introduction</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/faq/">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/en/docs/types/">Type Annotations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/">Type Annotations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/primitives/">Primitive Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/literals/">Literal Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/mixed/">Mixed</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/empty/">Empty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/any/">Any</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/maybe/">Maybe Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/functions/">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/objects/">Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/arrays/">Arrays</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/tuples/">Tuples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/classes/">Classes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/aliases/">Type Aliases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/opaque-types/">Opaque Type Aliases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/interfaces/">Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/generics/">Generics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/unions/">Unions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/intersections/">Intersections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/indexed-access/">Indexed Access Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/conditional/">Conditional Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/mapped-types/">Mapped Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/types/type-guards/">Type Guards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/typeof/">Typeof Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/casting/">Type Casting Expressions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/utilities/">Utility Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/modules/">Module Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/types/comments/">Comment Types</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/lang/types-and-expressions/">Type System</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/react/">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/enums/">Flow Enums</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/declarations/">Declarations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/libdefs/">Library Definitions</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/errors/">Error Suppressions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/linting/">Linting</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/strict/">Flow Strict</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/cli/">Flow CLI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/config/">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/tools/babel/">Tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/en/docs/editors/">Editors</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Type Guards</h1></header><p>Flow lets you define functions whose return expression encodes some type predicate over a parameter <code>param</code>. This predicate is annotated in place of a return type annotation as <code>param is PredicateType</code>. It declares that if the function returns <code>true</code> then <code>param</code> is of type <code>PredicateType</code>.</p><p>The syntax for a function like this is:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">predicate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">InputType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> param </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token maybe-class-name">PredicateType</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">some_expression</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The type of this function can also be written in terms of a type guard annotation:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">PredicateFunc</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">InputType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> param </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token maybe-class-name">PredicateType</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="toc-basic-usage">Basic Usage<a href="#toc-basic-usage" class="hash-link" aria-label="Direct link to Basic Usage" title="Direct link to Basic Usage">​</a></h2><p>Let&#x27;s see a simple example where we define a type guard function and then use it to refine some values.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-a-type-guard-function">Defining a type guard function<a href="#defining-a-type-guard-function" class="hash-link" aria-label="Direct link to Defining a type guard function" title="Direct link to Defining a type guard function">​</a></h3><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;A&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name constant" style="color:#36acaa">B</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;B&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">AorB</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">B</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">4</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">5</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">AorB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> value </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">6</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;A&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">7</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button></div></div><p>We have defined a data type <code>AorB</code> that is a disjoint union of two types <code>A</code> and <code>B</code> that each have a property <code>type</code> used as tag.</p><p>We have also written a <em>user defined type guard</em> function <code>isA</code> defined over objects of type <code>AorB</code>. This function returns <code>true</code> when the value of of the <code>type</code> property of its input is <code>&quot;A&quot;</code>. Using the definitions of <code>A</code> and <code>B</code>, Flow can prove that when the value of <code>type</code> is <code>&quot;A&quot;</code> then the type of <code>value</code> will be <code>A</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-a-type-guard-function-to-refine-values">Using a type guard function to refine values<a href="#using-a-type-guard-function-to-refine-values" class="hash-link" aria-label="Direct link to Using a type guard function to refine values" title="Direct link to Using a type guard function to refine values">​</a></h3><p>Functions that have a declared type guard can be used to refine values in conditionals. In the example above, we can use <code>isA</code> to refine a variable of type <code>AorB</code> to just <code>A</code>:</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;A&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name constant" style="color:#36acaa">B</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;B&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">AorB</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">B</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">4</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">5</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">AorB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> value </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">6</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;A&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">7</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">8</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">9</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">AorB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">10</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">11</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// `x` has now been refined to type A.</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">12</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// We can assign it variables of type A ...</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">13</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> y</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">A</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">14</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...and access A&#x27;s properties through `x`</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">15</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> stringData</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">16</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">17</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// As a sanity check, the following assignment to B will error</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">18</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> error</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">B</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                     </span><span class="flowErrorUnderline_swOQ"> </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                     </span><span class="flowErrorUnderline_swOQ"> </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">19</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">20</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>18:22-18:22: Cannot assign `x` to `error` because string [1] is incompatible with number [2] in property `data`. [incompatible-type]</div><div>18:22-18:22: Cannot assign `x` to `error` because string literal `A` [1] is incompatible with string literal `B` [2] in property `type`. [incompatible-type]</div></pre></div></div><p>In the then-branch of the conditional <code>if (isA(x))</code>, <code>x</code> will have the type <code>A</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="one-sided-type-guards">One-sided Type Guards<a href="#one-sided-type-guards" class="hash-link" aria-label="Direct link to One-sided Type Guards" title="Direct link to One-sided Type Guards">​</a></h3><p><strong>Note:</strong> This feature is available as of v0.237.0 when option <code>one_sided_type_guards=true</code> is set in the flowconfig. It is enabled by default as of v0.239.0.</p><p>In some cases we may want to declare that a type guard function only refines the then-branch of a conditional. Consider for example the function</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isPositive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">boolean</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button></div></div><p>If we declared <code>n is number</code> as the type guard of this function then in the following code:</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">declare</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isPositive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// n is number here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// n would be null | void here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>we would be able to establish that <code>n</code> is <code>null | void</code> in the else-branch. This is not true, however, since <code>n</code> could just be a non-negative number.</p><p>One-sided type guards, which we annotate as <code>implies param is PredicateType</code>, let us specify that a predicate narrows the type in only the positive case. For example,</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isPositive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> implies n </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button></div></div><p>Now, we&#x27;ll get the following behavior</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">declare</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isPositive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// n is number here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// n is still ?number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="refine-with-arrayfilter">Refine with <code>Array.filter</code><a href="#refine-with-arrayfilter" class="hash-link" aria-label="Direct link to refine-with-arrayfilter" title="Direct link to refine-with-arrayfilter">​</a></h2><p>Flow recognizes when you call <code>filter</code> on an array of type <code>Array&lt;T&gt;</code> with a callback function that holds a type guard with type <code>(value: T) =&gt; value is S</code>.
It will use this to produce an output array of type <code>Array&lt;S&gt;</code>. Note that <code>S</code> needs to be a subtype of the type of the array element <code>T</code>.</p><p>For example</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Success</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $ReadOnly</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;success&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> $ReadOnly</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;error&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> error</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">4</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Response</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">5</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token maybe-class-name">Success</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">6</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token known-class-name class-name">Error</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">7</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">8</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">filterSuccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Response</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Success</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">9</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">10</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> response </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token maybe-class-name">Success</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;success&#x27;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">11</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">12</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">13</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">14</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">filterError1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Response</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token known-class-name class-name">Error</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">15</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">16</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> response </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token maybe-class-name">Success</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;success&#x27;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">17</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">18</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// The following is expected to error</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">19</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">         </span><span class="flowErrorUnderline_swOQ">      </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">         </span><span class="flowErrorUnderline_swOQ">      </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">         </span><span class="flowErrorUnderline_swOQ">      </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">20</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">21</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">22</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">filterError2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Response</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token known-class-name class-name">Error</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">23</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">24</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// The following is expected to error</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">25</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> response </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token known-class-name class-name">Error</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;success&#x27;</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                </span><span class="flowErrorUnderline_swOQ">                 </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                </span><span class="flowErrorUnderline_swOQ">                 </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                            </span><span class="flowErrorUnderline_swOQ">     </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                </span><span class="flowErrorUnderline_swOQ">                 </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">26</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">27</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">28</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>19:10-19:15: Cannot return `result` because property `error` is missing in object type [1] but exists in object type [2] in array element. [prop-missing]</div><div>19:10-19:15: Cannot return `result` because property `value` is missing in object type [1] but exists in object type [2] in array element. [prop-missing]</div><div>19:10-19:15: Cannot return `result` because string literal `success` [1] is incompatible with string literal `error` [2] in property `type` of array element. [incompatible-return]</div><div>25:17-25:33: Inconsistent type guard declaration because property `error` is missing in object type [1] but exists in object type [2]. The type of `response` [3] refined with the predicate encoded in return expression `response.type === &#x27;success&#x27;` [4] needs to be compatible with the guard type `Error` [2]. See 1. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [prop-missing]</div><div>25:17-25:33: Inconsistent type guard declaration because string literal `success` [1] is incompatible with string literal `error` [2] in property `type`. The type of `response` [3] refined with the predicate encoded in return expression `response.type === &#x27;success&#x27;` [4] needs to be compatible with the guard type `Error` [5]. See 1. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [incompatible-type-guard]</div><div>25:29-25:33: Inconsistent type guard declaration because property `value` is missing in object type [1] but exists in object type [2]. The type of `response` [3] refined with the predicate encoded in return expression `response.type === &#x27;success&#x27;` [4] needs to be compatible with the guard type `Error` [1]. See 1. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [prop-missing]</div><div>25:17-25:33: Inconsistent type guard declaration. The negation of the predicate encoded in return expression `response.type === &#x27;success&#x27;` [1] needs to completely refine away the guard type `Error` [2]. Consider using a one-sided type-guard (`implies x is T`). See 2. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [incompatible-type-guard]</div></pre></div></div><p>In <code>filterError1</code>, filtering produces <code>Array&lt;Success&gt;</code> that is not compatible with the expected return type <code>Array&lt;Error&gt;</code>.</p><p>In <code>filterError2</code>, the predicate <code>response.type === &#x27;success&#x27;</code> is used to refine <code>Response</code>s to <code>Success</code>s, not <code>Error</code>s.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="toc-restrictions-of-type-guard-functions">Defining Type Guard Functions<a href="#toc-restrictions-of-type-guard-functions" class="hash-link" aria-label="Direct link to Defining Type Guard Functions" title="Direct link to Defining Type Guard Functions">​</a></h2><p>To ensure that refinement with type guard functions is sound, Flow runs a number of checks associated with these functions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="predicate-parameter-is-a-regular-parameter-to-the-function">Predicate parameter is a regular parameter to the function<a href="#predicate-parameter-is-a-regular-parameter-to-the-function" class="hash-link" aria-label="Direct link to Predicate parameter is a regular parameter to the function" title="Direct link to Predicate parameter is a regular parameter to the function">​</a></h3><p>In a type guard annotation of the form <code>parameter is Type</code>, <code>parameter</code> needs to belong to the current function&#x27;s parameter list.</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">missing</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">param</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> prop </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                </span><span class="flowErrorUnderline_swOQ">    </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> param </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:33-1:36: Cannot find type guard parameter `prop` [1] in the parameters of this function (type). [function-predicate]</div></pre></div></div><p>It cannot be a parameter bound in a destructuring pattern, or a rest paramter:</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">destructuring</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">prop</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">prop</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> prop </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                               </span><span class="flowErrorUnderline_swOQ">    </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> prop </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:48-1:51: A type guard parameter `prop` [1] cannot reference pattern parameter `prop` [2]. [function-predicate]</div></pre></div></div><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">mixed</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> value </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">mixed</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                       </span><span class="flowErrorUnderline_swOQ">     </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:40-1:44: A type guard parameter `value` [1] cannot reference rest parameter `value` [2]. [function-predicate]</div></pre></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="predicate-type-is-consistent-with-the-parameter-type">Predicate type is consistent with the parameter type<a href="#predicate-type-is-consistent-with-the-parameter-type" class="hash-link" aria-label="Direct link to Predicate type is consistent with the parameter type" title="Direct link to Predicate type is consistent with the parameter type">​</a></h3><p>The type guard <code>Type</code> needs to be compatible with the type of the parameter. In other words, given a definition</p><div class="language-tsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-tsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ParamType</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token maybe-class-name">Type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Flow will check that <code>Type</code> is a subtype of <code>ParamType</code>. So the following will be an error:</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                   </span><span class="flowErrorUnderline_swOQ">      </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:36-1:41: Cannot use number [1] as type prediate for parameter `x` because number [1] is incompatible with string [2]. A user defined type guard needs to be compatible with its parameter&#x27;s type. [incompatible-type-guard]</div></pre></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="type-guard-function-returns-boolean">Type guard function returns boolean<a href="#type-guard-function-returns-boolean" class="hash-link" aria-label="Direct link to Type guard function returns boolean" title="Direct link to Type guard function returns boolean">​</a></h3><p>A type guard function needs to return a boolean expression. The following are invalid declarations:</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isNumberNoReturn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                      </span><span class="flowErrorUnderline_swOQ">           </span></div></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:39-1:49: Cannot declare a type predicate [1] for function [2] because boolean [1] is incompatible with implicitly-returned undefined. [incompatible-return]</div></pre></div></div><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token generic-function function" style="color:#d73a49">nonMaybe</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name constant" style="color:#36acaa">V</span><span class="token generic-function generic class-name operator" style="color:#393A34">:</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name punctuation" style="color:#393A34">{</span><span class="token generic-function generic class-name operator" style="color:#393A34">...</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">}</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token constant" style="color:#36acaa">V</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">V</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">         </span><span class="flowErrorUnderline_swOQ"> </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">         </span><span class="flowErrorUnderline_swOQ"> </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>2:10-2:10: Cannot return `x` because null or undefined [1] is incompatible with boolean [2]. [incompatible-return]</div><div>2:10-2:10: Cannot return `x` because object type [1] is incompatible with boolean [2]. [incompatible-return]</div></pre></div></div><p>A correct version of <code>nonMaybe</code> would be</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token generic-function function" style="color:#d73a49">nonMaybe</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name constant" style="color:#36acaa">V</span><span class="token generic-function generic class-name operator" style="color:#393A34">:</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name punctuation" style="color:#393A34">{</span><span class="token generic-function generic class-name operator" style="color:#393A34">...</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">}</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token constant" style="color:#36acaa">V</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">V</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="toc-consistency-checks-of-type-guard-functions">Predicate type is consistent with refined type<a href="#toc-consistency-checks-of-type-guard-functions" class="hash-link" aria-label="Direct link to Predicate type is consistent with refined type" title="Direct link to Predicate type is consistent with refined type">​</a></h3><p>In addition to the above checks, Flow also ensures that the declared type guard is consistent with the check happening in the body of the function. To establish this it needs to guarantee two things:</p><ol><li>The type of the refined parameter at the return location <em>after</em> the predicate of the return expression has been applied is a subtype of the guard type. For example, the following definitions are correct:</li></ol><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">numOrStr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">4</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">5</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">numOrStrWithException</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                          </span><span class="flowErrorUnderline_swOQ">                    </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                          </span><span class="flowErrorUnderline_swOQ">                    </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">6</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">7</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">8</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">9</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">10</span><span class="codeBlockLineContent_Nema"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">11</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">12</span><span class="codeBlockLineContent_Nema"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">13</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">14</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">15</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>5:43-5:62: Inconsistent type guard declaration. The negation of the predicate encoded in return expression `true` [1] needs to completely refine away the guard type union type [2]. Consider using a one-sided type-guard (`implies x is T`). See 2. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [incompatible-type-guard]</div><div>5:43-5:62: Inconsistent type guard declaration. The negation of the predicate encoded in return expression `true` [1] needs to completely refine away the guard type union type [2]. Consider using a one-sided type-guard (`implies x is T`). See 2. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [incompatible-type-guard]</div></pre></div></div><p>But in the following Flow will raise errors:</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">numOrStrError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                  </span><span class="flowErrorUnderline_swOQ">                    </span></div><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                  </span><span class="flowErrorUnderline_swOQ">                    </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;boolean&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:35-1:54: Inconsistent type guard declaration because: [incompatible-type-guard] Either boolean [1] is incompatible with number [2]. Or boolean [1] is incompatible with string [3]. 
The type of `x` [4] refined with the predicate encoded in return expression `((typeof x) === &quot;number&quot;) || ((typeof x) === &quot;boolean&quot;)` [5] needs to be compatible with the guard type union type [6]. See 1. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions.</div><div>1:35-1:54: Inconsistent type guard declaration. The negation of the predicate encoded in return expression `((typeof x) === &quot;number&quot;) || ((typeof x) === &quot;boolean&quot;)` [1] needs to completely refine away the guard type union type [2]. Consider using a one-sided type-guard (`implies x is T`). See 2. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [incompatible-type-guard]</div></pre></div></div><ol start="2"><li>Type guard functions can be used to refine the else-branch of conditionals. For example,</li></ol><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">4</span><span class="codeBlockLineContent_Nema"><span class="token plain" style="display:inline-block">
</span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">5</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">declare</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">6</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">7</span><span class="codeBlockLineContent_Nema"><span class="token plain">  value </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// okay</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">8</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">9</span><span class="codeBlockLineContent_Nema"><span class="token plain">  value </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// also okay</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">10</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button></div></div><p>Therefore, the inverse form of the first requirement also needs to hold. Specifically, if we negate the predicate encoded in the function, and use it to refine the input, then the result must not overlap with the type guard at all. This condition is equivalent to checking that the type guard refined with the negation of the function predicate is a subtype of <code>empty</code>. For example the following raises an error:</p><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isPosNum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                             </span><span class="flowErrorUnderline_swOQ">           </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;number&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:30-1:40: Inconsistent type guard declaration. The negation of the predicate encoded in return expression `((typeof x) === &#x27;number&#x27;) &amp;&amp; (x &gt; 0)` [1] needs to completely refine away the guard type number [2]. Consider using a one-sided type-guard (`implies x is T`). See 2. in https://flow.org/en/docs/types/type-guards/#toc-consistency-checks-of-type-guard-functions. [incompatible-type-guard]</div></pre></div></div><p>This is because the negation of the predicate of <code>isPosNum</code> is &quot;<code>x</code> is not a number or <code>x&lt;=0</code>&quot;. This predicate is equivalent to the empty predicate and does not refine the input type it is applied to.</p><p>If you&#x27;re seeing errors related to this check, consider using a one-sided type guard (write <code>implies x is T</code>). Ones-sided type guards do not require this check, since they do not refine the else-branch of conditionals.</p><p><strong>Note:</strong> This check only happens when <code>one_sided_type_guards=true</code> is set in the flowconfig. It happens by default as of v0.239.0.</p><ol start="3"><li>The parameter that is refined cannot be reassigned in the body of the type guard function. Therefore the following are errors:</li></ol><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isNumberError1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">         </span><span class="flowErrorUnderline_swOQ">                     </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">4</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>3:10-3:30: Cannot use type guard parameter `x` [1] because at this return point it is written to in [2]. [function-predicate]</div></pre></div></div><div class="codeBlockContainer_r6yT"><div class="codeBlockContent_Ttwj tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_ec6o thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_pvST"><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">1</span><span class="codeBlockLineContent_Nema"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isNumberError2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> mixed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><div class="flowErrorUnderlineContainer_r80d"><span class="flowErrorUnderlineLeftPadding_BT3g">                                   </span><span class="flowErrorUnderline_swOQ"> </span></div></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">2</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">3</span><span class="codeBlockLineContent_Nema"><span class="token plain">    x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">4</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">5</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">6</span><span class="codeBlockLineContent_Nema"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;number&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeBlockLine_WHOb" style="color:#393A34"><span class="codeBlockLineNumber_gZUW">7</span><span class="codeBlockLineContent_Nema"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><button type="button" aria-label="" class="copyButton_Szi8 clean-btn">Copy</button><pre class="flowErrors_qefp"><div>1:36-1:36: Cannot use type guard parameter `x`, because `x` [1] is reassigned in [2]. [function-predicate]</div></pre></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="toc-adoption">Adoption<a href="#toc-adoption" class="hash-link" aria-label="Direct link to Adoption" title="Direct link to Adoption">​</a></h2><p>To use type guards, you need to upgrade your infrastructure so that it supports the syntax:</p><ul><li><code>flow</code> and <code>flow-parser</code>: 0.209.1. Between v0.209.1 to v0.211.1, you need to explicitly enable it in your .flowconfig, under the <code>[options]</code> heading, add <code>type_guards=true</code>. One-sided type guards are available as of version 0.237.0 with the option <code>one_sided_type_guards=true</code>, and are enabled by default as of v0.239.0.</li><li><code>prettier</code>: 3</li><li><code>babel</code> with <code>babel-plugin-syntax-hermes-parser</code>. See <a href="/en/docs/tools/babel/">our Babel guide</a> for setup instructions.</li><li><code>eslint</code> with <code>hermes-eslint</code>. See <a href="/en/docs/tools/eslint/">our ESLint guide</a> for setup instructions.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/flow/edit/main/website/docs/types/type-guards.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/types/mapped-types/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Mapped Types</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/types/typeof/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Typeof Types</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#toc-basic-usage" class="table-of-contents__link toc-highlight">Basic Usage</a><ul><li><a href="#defining-a-type-guard-function" class="table-of-contents__link toc-highlight">Defining a type guard function</a></li><li><a href="#using-a-type-guard-function-to-refine-values" class="table-of-contents__link toc-highlight">Using a type guard function to refine values</a></li><li><a href="#one-sided-type-guards" class="table-of-contents__link toc-highlight">One-sided Type Guards</a></li></ul></li><li><a href="#refine-with-arrayfilter" class="table-of-contents__link toc-highlight">Refine with <code>Array.filter</code></a></li><li><a href="#toc-restrictions-of-type-guard-functions" class="table-of-contents__link toc-highlight">Defining Type Guard Functions</a><ul><li><a href="#predicate-parameter-is-a-regular-parameter-to-the-function" class="table-of-contents__link toc-highlight">Predicate parameter is a regular parameter to the function</a></li><li><a href="#predicate-type-is-consistent-with-the-parameter-type" class="table-of-contents__link toc-highlight">Predicate type is consistent with the parameter type</a></li><li><a href="#type-guard-function-returns-boolean" class="table-of-contents__link toc-highlight">Type guard function returns boolean</a></li><li><a href="#toc-consistency-checks-of-type-guard-functions" class="table-of-contents__link toc-highlight">Predicate type is consistent with refined type</a></li></ul></li><li><a href="#toc-adoption" class="table-of-contents__link toc-highlight">Adoption</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/getting-started/">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/flowtype" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/8ezwRUK" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://medium.com/flow-type" target="_blank" rel="noopener noreferrer" class="footer__link-item">Medium</a></li><li class="footer__item"><a href="https://github.com/facebook/flow" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2024 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2e347048.js"></script>
<script src="/assets/js/main.28c37e05.js"></script>
</body>
</html>